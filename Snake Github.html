                    <div id="store-tabs" class="flex gap-2 mb-2">
                        <button data-tab="general" id="store-tab-general" class="store-tab menu-option-button active">GENERAL</button>
                        <button data-tab="recursos" id="store-tab-recursos" class="store-tab menu-option-button">
                            <img src="https://i.imgur.com/WDpRCFy.png" alt="Monedas y Gemas">
                        </button>
                        <button data-tab="comida" id="store-tab-comida" class="store-tab menu-option-button">
                            <img src="https://i.imgur.com/fOSSwUX.png" alt="Comida">
                        </button>
        let totalGems = 0;
        const HEART_PRICE = 100;
        const GEM_PRICE = 1000;
        const COIN_PACKS = [
            { id: 'coins1', amount: 1000, cost: 1, img: 'https://i.imgur.com/walqd0H.png' },
            { id: 'coins2', amount: 7500, cost: 5, img: 'https://i.imgur.com/iGzWFgy.png' },
            { id: 'coins3', amount: 20000, cost: 10, img: 'https://i.imgur.com/5dEsR4i.png' }
        ];
        const GEM_PACKS = [
            { id: 'gems1', amount: 10, cost: '0.99€', img: 'https://i.imgur.com/Qoo648i.png' },
            { id: 'gems2', amount: 50, cost: '2.99€', img: 'https://i.imgur.com/Sk6SMrC.png' },
            { id: 'gems3', amount: 100, cost: '4.99€', img: 'https://i.imgur.com/w15V6yf.png' }
        ];
        let storeTab = 'general';
        let profileTab = 'general';
            } else if (storeTab === 'escenarios') {
                SCENE_ORDER.forEach(key => {
                    const item = document.createElement('div');
                    item.className = 'store-item scene-item';
                    item.appendChild(status);
                    storeItemsContainer.appendChild(item);
                });
            } else if (storeTab === 'recursos') {
                COIN_PACKS.forEach(pack => {
                    const item = document.createElement('div');
                    item.className = 'store-item';
                    const img = document.createElement('img');
                    img.className = 'store-item-img';
                    img.src = pack.img;
                    item.appendChild(img);
                    const status = document.createElement('div');
                    status.className = 'store-item-status';
                    status.textContent = pack.cost.toString();
                    const gemIcon = document.createElement('img');
                    gemIcon.src = 'https://i.imgur.com/gPGsaCO.png';
                    gemIcon.alt = 'Gema';
                    gemIcon.style.width = '14px';
                    gemIcon.style.height = '14px';
                    gemIcon.style.marginLeft = '2px';
                    status.appendChild(gemIcon);
                    item.appendChild(status);
                    item.addEventListener('click', () => openPurchaseConfirm('coins', pack.id));
                    addIconPressEvents(item, item);
                    storeItemsContainer.appendChild(item);
                });
                GEM_PACKS.forEach(pack => {
                    const item = document.createElement('div');
                    item.className = 'store-item';
                    const img = document.createElement('img');
                    img.className = 'store-item-img';
                    img.src = pack.img;
                    item.appendChild(img);
                    const status = document.createElement('div');
                    status.className = 'store-item-status';
                    status.textContent = pack.cost;
                    item.appendChild(status);
                    item.addEventListener('click', () => openPurchaseConfirm('gems', pack.id));
                    addIconPressEvents(item, item);
                    storeItemsContainer.appendChild(item);
                });
            } else {
                const generalItems = [
                    { key: 'heart', price: HEART_PRICE, img: 'https://i.imgur.com/WrI2XXx.png' },
                    { key: 'gem', price: GEM_PRICE, img: 'https://i.imgur.com/gPGsaCO.png' }
                ];
                if (type === 'food') {
                    img.src = FOODS[key]?.asset?.src || '';
                } else if (type === 'skin') {
                    img.src = SKINS[key]?.snakeHeadAsset?.upDown?.src || '';
                } else if (type === 'scene') {
                    img.classList.add('scene-img-full');
                    img.src = SCENES[key]?.icon || '';
                } else if (type === 'general') {
                    img.src = key === 'heart' ? 'https://i.imgur.com/WrI2XXx.png' : 'https://i.imgur.com/gPGsaCO.png';
                } else if (type === 'coins') {
                    const pack = COIN_PACKS.find(p => p.id === key);
                    if (pack) img.src = pack.img;
                } else if (type === 'gems') {
                    const pack = GEM_PACKS.find(p => p.id === key);
                    if (pack) img.src = pack.img;
                }
                purchaseItemPreview.appendChild(img);
            }
            let price = 0;
            let name = '';
            let customMessage = '';
            if (type === 'food') {
                price = FOODS[key].price;
                name = FOOD_DISPLAY_NAMES[key];
            } else if (type === 'skin') {
                price = SKIN_PRICES[key];
                name = SKIN_DISPLAY_NAMES[key];
            } else if (type === 'scene') {
                price = SCENE_PRICES[key];
                name = SCENE_DISPLAY_NAMES[key];
            } else if (type === 'general') {
                price = key === 'heart' ? HEART_PRICE : GEM_PRICE;
                name = key === 'heart' ? 'coraz\u00F3n' : 'gema';
            } else if (type === 'coins') {
                const pack = COIN_PACKS.find(p => p.id === key);
                if (pack) {
                    price = pack.cost;
                    name = `${pack.amount} monedas`;
                    customMessage = `¿Comprar ${name} por <strong>${price}</strong> gemas?`;
                }
            } else if (type === 'gems') {
                const pack = GEM_PACKS.find(p => p.id === key);
                if (pack) {
                    price = pack.cost;
                    name = `${pack.amount} gemas`;
                    customMessage = `¿Comprar ${name} por <strong>${price}</strong>?`;
                }
            }
            if (purchaseConfirmationText) {
                purchaseConfirmationText.innerHTML = customMessage || `¿Comprar ${name} por <strong>${price}</strong> monedas?`;
            }
            purchaseConfirmationPanel.classList.add('centered-panel');
            togglePanel(purchaseConfirmationPanel, purchaseConfirmationPanel.querySelector('.panel-content'), true);
            if (modalOverlay) modalOverlay.classList.remove('hidden');
        }

        function confirmPurchase() {
            if (!purchaseInfo) { closePurchaseConfirm(); return; }
            if (purchaseInfo.type === 'gems') { closePurchaseConfirm(); return; }
            let price = 0;
            let success = false;
            let failureMessage;
            if (purchaseInfo.type === 'food') {
                price = FOODS[purchaseInfo.key].price;
                if (totalCoins >= price) {
                    totalCoins -= price;
                    unlockedFoods[purchaseInfo.key] = true;
                } else if (purchaseInfo.key === 'gem') {
                    price = GEM_PRICE;
                    if (totalCoins >= price) {
                        totalCoins -= price;
                        const prev = totalGems;
                        totalGems++;
                        saveGems();
                        showEarnedGemsMessage(1);
                        setTimeout(() => {
                            animateGemGain(prev, totalGems);
                        }, COIN_MESSAGE_DISPLAY_TIME);
                        success = true;
                    }
                }
            } else if (purchaseInfo.type === 'coins') {
                const pack = COIN_PACKS.find(p => p.id === purchaseInfo.key);
                if (pack) {
                    price = pack.cost;
                    if (totalGems >= price) {
                        totalGems -= price;
                        saveGems();
                        updateGemDisplay();
                        const previousCoins = totalCoins;
                        totalCoins += pack.amount;
                        showEarnedCoinsMessage(pack.amount);
                        setTimeout(() => { animateCoinGain(previousCoins, totalCoins); }, COIN_MESSAGE_DISPLAY_TIME);
                        success = true;
                    } else {
                        failureMessage = 'Gemas insuficientes';
                    }
                }
            }
            if (success) {
                localStorage.setItem('snakeGameCoins', totalCoins.toString());
                updateCoinDisplay();
                populateStoreItems();
                closePurchaseConfirm();
            } else {
                showInsufficientFundsToast(failureMessage);
            }
        }
                    <div id="store-tabs" class="flex gap-2 mb-2">
                        <button data-tab="general" id="store-tab-general" class="store-tab menu-option-button active">GENERAL</button>
                        <button data-tab="recursos" id="store-tab-recursos" class="store-tab menu-option-button">
                            <img src="https://i.imgur.com/WDpRCFy.png" alt="Monedas y Gemas">
                        </button>
                        <button data-tab="comida" id="store-tab-comida" class="store-tab menu-option-button">
                            <img src="https://i.imgur.com/fOSSwUX.png" alt="Comida">
                        </button>
        let currentScene = 'classic';
        let totalGems = 0;
        const HEART_PRICE = 100;
        const GEM_PRICE = 1000;
        const COIN_PACKS = [
            { id: 'coins1', amount: 1000, cost: 1, img: 'https://i.imgur.com/walqd0H.png' },
            { id: 'coins2', amount: 7500, cost: 5, img: 'https://i.imgur.com/iGzWFgy.png' },
            { id: 'coins3', amount: 20000, cost: 10, img: 'https://i.imgur.com/5dEsR4i.png' }
        ];
        const GEM_PACKS = [
            { id: 'gems1', amount: 10, cost: '0.99€', img: 'https://i.imgur.com/Qoo648i.png' },
            { id: 'gems2', amount: 50, cost: '2.99€', img: 'https://i.imgur.com/Sk6SMrC.png' },
            { id: 'gems3', amount: 100, cost: '4.99€', img: 'https://i.imgur.com/w15V6yf.png' }
        ];
        let storeTab = 'general';
        let profileTab = 'general';
                    item.appendChild(status);
                    storeItemsContainer.appendChild(item);
                });
            } else if (storeTab === 'recursos') {
                COIN_PACKS.forEach(pack => {
                    const item = document.createElement('div');
                    item.className = 'store-item';
                    const img = document.createElement('img');
                    img.className = 'store-item-img';
                    img.src = pack.img;
                    item.appendChild(img);
                    const status = document.createElement('div');
                    status.className = 'store-item-status';
                    status.textContent = pack.cost.toString();
                    const gemIcon = document.createElement('img');
                    gemIcon.src = 'https://i.imgur.com/gPGsaCO.png';
                    gemIcon.alt = 'Gema';
                    gemIcon.style.width = '14px';
                    gemIcon.style.height = '14px';
                    gemIcon.style.marginLeft = '2px';
                    status.appendChild(gemIcon);
                    item.appendChild(status);
                    item.addEventListener('click', () => openPurchaseConfirm('coins', pack.id));
                    addIconPressEvents(item, item);
                    storeItemsContainer.appendChild(item);
                });
                GEM_PACKS.forEach(pack => {
                    const item = document.createElement('div');
                    item.className = 'store-item';
                    const img = document.createElement('img');
                    img.className = 'store-item-img';
                    img.src = pack.img;
                    item.appendChild(img);
                    const status = document.createElement('div');
                    status.className = 'store-item-status';
                    status.textContent = pack.cost;
                    item.appendChild(status);
                    item.addEventListener('click', () => openPurchaseConfirm('gems', pack.id));
                    addIconPressEvents(item, item);
                    storeItemsContainer.appendChild(item);
                });
            } else {
                const generalItems = [
                    { key: 'heart', price: HEART_PRICE, img: 'https://i.imgur.com/WrI2XXx.png' },
                    { key: 'gem', price: GEM_PRICE, img: 'https://i.imgur.com/gPGsaCO.png' }
                ];
                if (type === 'food') {
                    img.src = FOODS[key]?.asset?.src || '';
                } else if (type === 'skin') {
                    img.src = SKINS[key]?.snakeHeadAsset?.upDown?.src || '';
                } else if (type === 'scene') {
                    img.classList.add('scene-img-full');
                    img.src = SCENES[key]?.icon || '';
                } else if (type === 'general') {
                    img.src = key === 'heart' ? 'https://i.imgur.com/WrI2XXx.png' : 'https://i.imgur.com/gPGsaCO.png';
                } else if (type === 'coins') {
                    const pack = COIN_PACKS.find(p => p.id === key);
                    if (pack) img.src = pack.img;
                } else if (type === 'gems') {
                    const pack = GEM_PACKS.find(p => p.id === key);
                    if (pack) img.src = pack.img;
                }
                purchaseItemPreview.appendChild(img);
            }
            let price = 0;
            let name = '';
            let customMessage = '';
            if (type === 'food') {
                price = FOODS[key].price;
                name = FOOD_DISPLAY_NAMES[key];
            } else if (type === 'skin') {
                price = SKIN_PRICES[key];
                name = SKIN_DISPLAY_NAMES[key];
            } else if (type === 'scene') {
                price = SCENE_PRICES[key];
                name = SCENE_DISPLAY_NAMES[key];
            } else if (type === 'general') {
                price = key === 'heart' ? HEART_PRICE : GEM_PRICE;
                name = key === 'heart' ? 'coraz\u00F3n' : 'gema';
            } else if (type === 'coins') {
                const pack = COIN_PACKS.find(p => p.id === key);
                if (pack) {
                    price = pack.cost;
                    name = `${pack.amount} monedas`;
                    customMessage = `¿Comprar ${name} por <strong>${price}</strong> gemas?`;
                }
            } else if (type === 'gems') {
                const pack = GEM_PACKS.find(p => p.id === key);
                if (pack) {
                    price = pack.cost;
                    name = `${pack.amount} gemas`;
                    customMessage = `¿Comprar ${name} por <strong>${price}</strong>?`;
                }
            }
            if (purchaseConfirmationText) {
                purchaseConfirmationText.innerHTML = customMessage || `¿Comprar ${name} por <strong>${price}</strong> monedas?`;
            }
            purchaseConfirmationPanel.classList.add('centered-panel');
            togglePanel(purchaseConfirmationPanel, purchaseConfirmationPanel.querySelector('.panel-content'), true);
            if (modalOverlay) modalOverlay.classList.remove('hidden');
        }

        function confirmPurchase() {
            if (!purchaseInfo) { closePurchaseConfirm(); return; }
            if (purchaseInfo.type === 'gems') { closePurchaseConfirm(); return; }
            let price = 0;
            let success = false;
            let failureMessage;
            if (purchaseInfo.type === 'food') {
                price = FOODS[purchaseInfo.key].price;
                if (totalCoins >= price) {
                    totalCoins -= price;
                    unlockedFoods[purchaseInfo.key] = true;
                } else if (purchaseInfo.key === 'gem') {
                    price = GEM_PRICE;
                    if (totalCoins >= price) {
                        totalCoins -= price;
                        const prev = totalGems;
                        totalGems++;
                        saveGems();
                        showEarnedGemsMessage(1);
                        setTimeout(() => {
                            animateGemGain(prev, totalGems);
                        }, COIN_MESSAGE_DISPLAY_TIME);
                        success = true;
                    }
                }
            } else if (purchaseInfo.type === 'coins') {
                const pack = COIN_PACKS.find(p => p.id === purchaseInfo.key);
                if (pack) {
                    price = pack.cost;
                    if (totalGems >= price) {
                        totalGems -= price;
                        saveGems();
                        updateGemDisplay();
                        const previousCoins = totalCoins;
                        totalCoins += pack.amount;
                        showEarnedCoinsMessage(pack.amount);
                        setTimeout(() => { animateCoinGain(previousCoins, totalCoins); }, COIN_MESSAGE_DISPLAY_TIME);
                        success = true;
                    } else {
                        failureMessage = 'Gemas insuficientes';
                    }
                }
            }
            if (success) {
                localStorage.setItem('snakeGameCoins', totalCoins.toString());
                updateCoinDisplay();
                populateStoreItems();
                closePurchaseConfirm();
            } else {
                showInsufficientFundsToast(failureMessage);
            }
        }
